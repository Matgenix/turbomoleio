<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>turbomoleio.core package &mdash; turbomoleio 1.1.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="turbomoleio.core.tests package" href="turbomoleio.core.tests.html" />
    <link rel="prev" title="turbomoleio package" href="turbomoleio.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> turbomoleio
          </a>
              <div class="version">
                1.1.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../datagroups.html">The data group files</a></li>
<li class="toctree-l1"><a class="reference internal" href="../coord.html">The coord file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../definerunner.html">Running define</a></li>
<li class="toctree-l1"><a class="reference internal" href="../output_parsing.html">Outputs parsing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../appendix.html">Appendix</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="modules.html">turbomoleio</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="turbomoleio.html">turbomoleio package</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="turbomoleio.html#subpackages">Subpackages</a></li>
<li class="toctree-l4"><a class="reference internal" href="turbomoleio.html#module-turbomoleio">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer/introduction.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/parsing_logs.html">Output logs parsing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/definerunner.html">Define runner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/versioning.html">Versioning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/versioning.html#backward-compatibility">Backward-compatibility</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bugs.html">Reporting bugs</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">turbomoleio</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../appendix.html">Appendix</a> &raquo;</li>
          <li><a href="modules.html">turbomoleio</a> &raquo;</li>
          <li><a href="turbomoleio.html">turbomoleio package</a> &raquo;</li>
      <li>turbomoleio.core package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/turbomoleio.core.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="turbomoleio-core-package">
<h1>turbomoleio.core package<a class="headerlink" href="#turbomoleio-core-package" title="Permalink to this headline"></a></h1>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline"></a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="turbomoleio.core.tests.html">turbomoleio.core.tests package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="turbomoleio.core.tests.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="turbomoleio.core.tests.html#module-turbomoleio.core.tests.test_control">turbomoleio.core.tests.test_control module</a></li>
<li class="toctree-l2"><a class="reference internal" href="turbomoleio.core.tests.html#module-turbomoleio.core.tests.test_datagroups">turbomoleio.core.tests.test_datagroups module</a></li>
<li class="toctree-l2"><a class="reference internal" href="turbomoleio.core.tests.html#module-turbomoleio.core.tests.test_molecule">turbomoleio.core.tests.test_molecule module</a></li>
<li class="toctree-l2"><a class="reference internal" href="turbomoleio.core.tests.html#module-turbomoleio.core.tests.test_periodic">turbomoleio.core.tests.test_periodic module</a></li>
<li class="toctree-l2"><a class="reference internal" href="turbomoleio.core.tests.html#module-turbomoleio.core.tests.test_utils">turbomoleio.core.tests.test_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="turbomoleio.core.tests.html#module-turbomoleio.core.tests">Module contents</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline"></a></h2>
</div>
<div class="section" id="module-turbomoleio.core.base">
<span id="turbomoleio-core-base-module"></span><h2>turbomoleio.core.base module<a class="headerlink" href="#module-turbomoleio.core.base" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.base.BaseSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.base.</span></span><span class="sig-name descname"><span class="pre">BaseSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule_or_structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodicity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/base.html#BaseSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.base.BaseSystem" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Common base class for MoleculeSystem and PeriodicSystem objects.</p>
<p>Common base for MoleculeSystem and PeriodicSystem objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule_or_structure</strong> – pymatgen Molecule or Structure.</p></li>
<li><p><strong>frozen_indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.10)"><em>set</em></a>) – a set of indices (0-based) indicating atoms
that should have fixed cartesian coordinates.</p></li>
<li><p><strong>periodicity</strong> – Periodicity of the system. Default is 0 for MoleculeSystem and
should be 1, 2 or 3 for PeriodicSystem.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.base.BaseSystem.coord_lines">
<span class="sig-name descname"><span class="pre">coord_lines</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/base.html#BaseSystem.coord_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.base.BaseSystem.coord_lines" title="Permalink to this definition"></a></dt>
<dd><p>Gives the lines of the $coord datagroup based on the internal Structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of strings with the $coord datagroup.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.base.BaseSystem.to_coord_file">
<span class="sig-name descname"><span class="pre">to_coord_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coord'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/base.html#BaseSystem.to_coord_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.base.BaseSystem.to_coord_file" title="Permalink to this definition"></a></dt>
<dd><p>Writes the system to a coord file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the path to the file</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.base.BaseSystem.to_coord_string">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">to_coord_string</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/base.html#BaseSystem.to_coord_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.base.BaseSystem.to_coord_string" title="Permalink to this definition"></a></dt>
<dd><p>Creates the string of a coord file for this system.</p>
<p>Should be implemented separately for molecules and periodic systems.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.base.BaseSystem.to_file">
<span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/base.html#BaseSystem.to_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.base.BaseSystem.to_file" title="Permalink to this definition"></a></dt>
<dd><p>Writes the system to a file depending on the specified format. Could be
a coord file or any other format supported by pymatgen Molecule or Structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – path to the file.</p></li>
<li><p><strong>fmt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the format of the data. could be “coord” for Turbomole
coord file or any format supported in pymatgen Molecule or Structure.
If None the code would try to infer it from the file name.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.base.get_coord_lines">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.base.</span></span><span class="sig-name descname"><span class="pre">get_coord_lines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/base.html#get_coord_lines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.base.get_coord_lines" title="Permalink to this definition"></a></dt>
<dd><p>Generates the lines contained in the $coord datagroup from a pymatgen Molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>Molecule</em>) – the molecule that should be converted.</p></li>
<li><p><strong>frozen_indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.10)"><em>set</em></a>) – indices of the molecule that should be frozen
(an “f” appended at the end of the line).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of strings with the lines of $coord.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.base.get_mol_and_indices_frozen">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.base.</span></span><span class="sig-name descname"><span class="pre">get_mol_and_indices_frozen</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cell_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/base.html#get_mol_and_indices_frozen"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.base.get_mol_and_indices_frozen" title="Permalink to this definition"></a></dt>
<dd><p>Extracts a pymatgen Molecule and indices of the frozen atoms from the
$coord datagroup.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – The string containing the list of coordinates.</p></li>
<li><p><strong>cell_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – The string containing the cell parameters.
For 1D periodic systems, cell consists of a single
number: “a” lattice parameter.
For 2D periodic systems, cell consists of 3 numbers:
“a” and “b” lattice parameters and Gamma angle between
“a” and “b”.
For 3D periodic systems, cell consists of 6 numbers:
“a”, “b” and “c” lattice parameters and Alpha, Beta and
Gamma angles between lattice parameters.
Only cell_string or lattice_string should be set for
periodic systems (not both).</p></li>
<li><p><strong>periodic_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – The string describing periodicity.</p></li>
<li><p><strong>lattice_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – The string containing the lattice
parameters as a matrix.
Only cell_string or lattice_string should be set for
periodic systems (not both).</p></li>
<li><p><strong>periodic_extension</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – For 1D and 2D periodic systems,
periodic_extension is the amount (in Angstroms of
artifically added vacuum in the Structure object in
the non-periodic directions).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>molecule: a pymatgen molecule or structure (when cell and
periodic are provided).
frozen_indices: a set with the indices of the frozen atoms.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>namedtuple</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-turbomoleio.core.control">
<span id="turbomoleio-core-control-module"></span><h2>turbomoleio.core.control module<a class="headerlink" href="#module-turbomoleio.core.control" title="Permalink to this headline"></a></h2>
<p>This module contains the object and functions to interact directly with a
control file. Based on the DataGroups class.</p>
<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.control.</span></span><span class="sig-name descname"><span class="pre">Control</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dg_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Control"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Control" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#turbomoleio.core.datagroups.DataGroups" title="turbomoleio.core.datagroups.DataGroups"><code class="xref py py-class docutils literal notranslate"><span class="pre">turbomoleio.core.datagroups.DataGroups</span></code></a></p>
<p>Represents the control string/file for TurboMole.</p>
<p>The <cite>Control</cite> class is used to store the parameters of a control file.
Parameters in a control file are stored as “Data Groups”. A data group
is a key-value pair storing data “value” for the specific “key”. Value may
be a single number, a string or a series of strings, numbers or
combinations thereof.</p>
<p>Initializes a <cite>Control</cite> class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> – The control string (in the data group format).
Usually read from file.</p></li>
<li><p><strong>dg_list</strong> – List of the data groups in the control string/file.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control.add_cosmo">
<span class="sig-name descname"><span class="pre">add_cosmo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nppa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nspa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disex</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rsolv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">routf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cavity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_old_amat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Control.add_cosmo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Control.add_cosmo" title="Permalink to this definition"></a></dt>
<dd><p>Adds the $cosmo datagroup to the control, using the keywords to set the cosmo options.
If None all the options will not be written to the control file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epsilon</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – permittivity used for scaling of the screening charges</p></li>
<li><p><strong>nppa</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – number of basis grid points per atom</p></li>
<li><p><strong>nspa</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – number of segments per atom</p></li>
<li><p><strong>disex</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – distance threshold for A matrix elements (Angstrom)</p></li>
<li><p><strong>rsolv</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – distance to outer solvent sphere for cavity construction (Angstrom)</p></li>
<li><p><strong>routf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – factor for outer cavity construction in the outlying charge correction</p></li>
<li><p><strong>cavity</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – acceptable values are “open” (leave untidy seams between atoms) and
“closed” (pave intersection seams with segments)</p></li>
<li><p><strong>use_old_amat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True adds the <code class="docutils literal notranslate"><span class="pre">use_old_amat</span></code> to the <code class="docutils literal notranslate"><span class="pre">$cosmo</span></code> datagroup,
i.e. uses A matrix setup of TURBOMOLE 5.7.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control.cpc">
<span class="sig-name descname"><span class="pre">cpc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dest_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Control.cpc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Control.cpc" title="Permalink to this definition"></a></dt>
<dd><p>Copies the control file and all files referenced here.
Creates the destination folder if not already existing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dest_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – path to the destination folder.</p></li>
<li><p><strong>force_overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True files already present in the
destination folder will be overwritten.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control.energy">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">energy</span></span><a class="headerlink" href="#turbomoleio.core.control.Control.energy" title="Permalink to this definition"></a></dt>
<dd><p>An Energy object with the data from the $energy data group.
None if the datagroup is absent/empty or if the file is missing.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'control'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Control.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Control.from_file" title="Permalink to this definition"></a></dt>
<dd><p>Creates Control object reading from a given file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Name of the file from which this Control object
should be read, default is “control”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control.from_metric">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Control.from_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Control.from_metric" title="Permalink to this definition"></a></dt>
<dd><p>Generates a new Control containing the value of the metric in $redund_inp
and an empty $coord.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metric</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the value of the metric</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control.get_charge">
<span class="sig-name descname"><span class="pre">get_charge</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Control.get_charge"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Control.get_charge" title="Permalink to this definition"></a></dt>
<dd><p>Extract the charge from the “$charge from xxx” datagroup.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the charge in the control file. None if not present.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control.get_shells">
<span class="sig-name descname"><span class="pre">get_shells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shells_type</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Control.get_shells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Control.get_shells" title="Permalink to this definition"></a></dt>
<dd><p>Extract a Shell object for a specific type of shell.
:param shells_type: the type of shell. Can be “closed”, “alpha” or “beta”.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>An instance of Shells</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control.get_subfiles_list">
<span class="sig-name descname"><span class="pre">get_subfiles_list</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Control.get_subfiles_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Control.get_subfiles_list" title="Permalink to this definition"></a></dt>
<dd><p>Extracts the list of files referenced in the datagroups with
“file=xxx” and “file xxx”.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list of files referenced in the datagroups.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control.gradient">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">gradient</span></span><a class="headerlink" href="#turbomoleio.core.control.Control.gradient" title="Permalink to this definition"></a></dt>
<dd><p>A Gradient object with the data from the $grad data group.
None if the datagroup is absent/empty or if the file is missing.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control.is_uhf">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_uhf</span></span><a class="headerlink" href="#turbomoleio.core.control.Control.is_uhf" title="Permalink to this definition"></a></dt>
<dd><p>True if the $uhf datagroup is present in control.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control.remove_last_energy">
<span class="sig-name descname"><span class="pre">remove_last_energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'control'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Control.remove_last_energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Control.remove_last_energy" title="Permalink to this definition"></a></dt>
<dd><p>Removes last energy step from the energy data group and writes it to
the correct file, depending on the original location of the data group.
N.B. if the energies are in control and not in an external file, this
will call the to_file of the current instance of Control. If other
modifications have been done to the dg_list will be written to the
file as well.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – name of the file to which the current instance of
Control will be written in case the energies are control.
If energies are in external file it will be ignored.</p></li>
<li><p><strong>backup_suffix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – if not None a file named filename+backup_suffix
will be created with the current content of Control.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if there is no energy step to be removed or if energy
    file is missing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control.remove_last_gradient">
<span class="sig-name descname"><span class="pre">remove_last_gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'control'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Control.remove_last_gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Control.remove_last_gradient" title="Permalink to this definition"></a></dt>
<dd><p>Removes last gradient step from the grad data group and writes it to
the correct file, depending on the original location of the data group.
N.B. if the gradients are in control and not in an external file, this
will call the to_file of the current instance of Control. If other
modifications have been done to the dg_list will be written to the
file as well.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – name of the file to which the current instance of
Control will be written in case the gradients are control.
If gradients are in external file it will be ignored.</p></li>
<li><p><strong>backup_suffix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – if not None a file named filename+backup_suffix
will be created with the current content of Control.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if there is no gradient step to be removed or if
    gradient file is missing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control.set_disp">
<span class="sig-name descname"><span class="pre">set_disp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dispersion_correction</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Control.set_disp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Control.set_disp" title="Permalink to this definition"></a></dt>
<dd><p>Sets the dispersion correction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dispersion_correction</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the name of the method used for the dispersion correction.
Supported values are “DFT-D1”, “DFT-D2” “DFT-D3” and “DFT-D3 BJ”, case insensitive.
If None all the “disp” datagroup will be eliminated.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Control.to_file">
<span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'control'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Control.to_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Control.to_file" title="Permalink to this definition"></a></dt>
<dd><p>Writes this Control object to a file.
If the file exists it will be overwritten.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Name of the file to which this Control object
should be written.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.control.Defaults">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.control.</span></span><span class="sig-name descname"><span class="pre">Defaults</span></span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Defaults"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Defaults" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Class collecting default values used by TM executables when not
present in the control file.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.control.Defaults.METRIC">
<span class="sig-name descname"><span class="pre">METRIC</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#turbomoleio.core.control.Defaults.METRIC" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.control.Energy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.control.</span></span><span class="sig-name descname"><span class="pre">Energy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scfkin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scfpot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mp2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Energy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Energy" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Represents the “energy” data group of TurboMole.
Usually stored in the “energy” file or directly in the control file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scf</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – energies from scf calculations.</p></li>
<li><p><strong>scfkin</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – kinetic contribution to the scf energy.</p></li>
<li><p><strong>scfpot</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – potential contribution to the scf energy.</p></li>
<li><p><strong>mp2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – mp2 contribution to the total energy (not counted in scf).</p></li>
</ul>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.control.Energy.delta_e">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">delta_e</span></span><a class="headerlink" href="#turbomoleio.core.control.Energy.delta_e" title="Permalink to this definition"></a></dt>
<dd><p>The variation of the total energy in the last step.
None if less than 2 steps presents.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Energy.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'energy'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Energy.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Energy.from_file" title="Permalink to this definition"></a></dt>
<dd><p>Creates Energy object reading from a given file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Name of the file from which this Energy object
should be read, default is “energy”.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if the energy file comes from a subfile and is missing.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Energy.from_string">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Energy.from_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Energy.from_string" title="Permalink to this definition"></a></dt>
<dd><p>Creates Energy object reading from a string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the string of the “energy” datagroup.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.control.Energy.n_steps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_steps</span></span><a class="headerlink" href="#turbomoleio.core.control.Energy.n_steps" title="Permalink to this definition"></a></dt>
<dd><p>The number of steps present.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Energy.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Energy.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Energy.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot the evolution of the energies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ax</strong> (<em>Axes</em>) – a matplotlib Axes or None if a new figure should be created.</p></li>
<li><p><strong>kwargs</strong> – arguments passed to matplotlib plot function.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A matplotlib Figure</p>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.control.Gradient">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.control.</span></span><span class="sig-name descname"><span class="pre">Gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gradients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">energies</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">molecules</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodicity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_vectors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_gradients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Gradient" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Represents the “grad” data group of TurboMole.
Usually stored in the “gradient” file or directly in the control file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gradients</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – gradients for all the steps and all the atoms
with shape nsteps*natoms*3.</p></li>
<li><p><strong>energies</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – total energies for each step.</p></li>
<li><p><strong>molecules</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of MoleculeSystem with coordinates for each step.</p></li>
<li><p><strong>periodicity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – periodicity of the system: 0 (default) or 1/2/3 for
calculations performed with riper.</p></li>
<li><p><strong>lattice_vectors</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of lattice vectors for each step. The number
and size of each lattice vector depends on the periodicity. For
1-dimensional systems, a single lattice vector of size one.</p></li>
<li><p><strong>lattice_gradients</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – lattice gradients for all the steps.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Gradient.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gradient'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Gradient.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Gradient.from_file" title="Permalink to this definition"></a></dt>
<dd><p>Creates Gradient object reading from a given file.</p>
<dl class="simple">
<dt>Note: For periodic systems, the lattice gradients are usually either</dt><dd><p>in the control file directly or in a different file. One option
is thus to initialize the Gradients object from the control file,
which will then get the atom gradients from the $grad datagroup
and the lattice gradient from the $gradlatt datagroup.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Name of the file from which this Gradient object
should be read, default is “gradient”.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Gradient.from_string">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lattice_string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Gradient.from_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Gradient.from_string" title="Permalink to this definition"></a></dt>
<dd><p>Creates Gradient object reading from a given file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the string of the “grad” datagroup.</p></li>
<li><p><strong>lattice_string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the string of the “gradlatt” datagroup.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.control.Gradient.last_grad_max">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">last_grad_max</span></span><a class="headerlink" href="#turbomoleio.core.control.Gradient.last_grad_max" title="Permalink to this definition"></a></dt>
<dd><p>The value of the maximum value of the gradient in the last step.
None if no steps presents.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.control.Gradient.last_grad_norm">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">last_grad_norm</span></span><a class="headerlink" href="#turbomoleio.core.control.Gradient.last_grad_norm" title="Permalink to this definition"></a></dt>
<dd><p>The value of the last gradient norm.
None if no steps presents.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.control.Gradient.max_gradients">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">max_gradients</span></span><a class="headerlink" href="#turbomoleio.core.control.Gradient.max_gradients" title="Permalink to this definition"></a></dt>
<dd><p>Norms of the largest gradients for each step.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.control.Gradient.n_steps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">n_steps</span></span><a class="headerlink" href="#turbomoleio.core.control.Gradient.n_steps" title="Permalink to this definition"></a></dt>
<dd><p>The number of steps present.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.control.Gradient.norms">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">norms</span></span><a class="headerlink" href="#turbomoleio.core.control.Gradient.norms" title="Permalink to this definition"></a></dt>
<dd><p>Total norm of the gradients for each step.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Gradient.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Gradient.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Gradient.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot the evolution of the maximum and the norm of the gradient.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> – arguments passed to matplotlib plot function.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A matplotlib Figure</p>
</dd>
</dl>
<p>Keyword arguments controlling the display of the figure:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 23%" />
<col style="width: 77%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>kwargs</p></th>
<th class="head"><p>Meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>title</p></td>
<td><p>Title of the plot (Default: None).</p></td>
</tr>
<tr class="row-odd"><td><p>show</p></td>
<td><p>True to show the figure (default: True).</p></td>
</tr>
<tr class="row-even"><td><p>savefig</p></td>
<td><p>“abc.png” or “abc.eps” to save the figure to a file.</p></td>
</tr>
<tr class="row-odd"><td><p>size_kwargs</p></td>
<td><p>Dictionary with options passed to fig.set_size_inches
e.g. size_kwargs=dict(w=3, h=4)</p></td>
</tr>
<tr class="row-even"><td><p>tight_layout</p></td>
<td><p>True to call fig.tight_layout (default: False)</p></td>
</tr>
<tr class="row-odd"><td><p>ax_grid</p></td>
<td><p>True (False) to add (remove) grid from all axes in fig.
Default: None i.e. fig is left unchanged.</p></td>
</tr>
<tr class="row-even"><td><p>ax_annotate</p></td>
<td><p>Add labels to  subplots e.g. (a), (b).
Default: False</p></td>
</tr>
<tr class="row-odd"><td><p>fig_close</p></td>
<td><p>Close figure. Default: False.</p></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.control.Shells">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.control.</span></span><span class="sig-name descname"><span class="pre">Shells</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">states</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">occupations</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Shells"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Shells" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Object describing the occupation of a type of shells.
It can map $closed shells, $alpha shells and $beta shells
($open shells not supported).
Handles integer, fractional and floating point occupations.
Occupations are stored as Fraction objects
Supports presence of the same irrep in multiple lines.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>states</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of tuples (irrep, irrep_index) with the occupied
states for each.</p></li>
<li><p><strong>occupations</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – list of Fraction with the occupations for each state.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Shells.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Shells.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Shells.as_dict" title="Permalink to this definition"></a></dt>
<dd><p>A JSON serializable dict representation of Shells.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Shells.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Shells.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Shells.from_dict" title="Permalink to this definition"></a></dt>
<dd><p>Generates an instance of Shell from a JSON serialized representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>d</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – the dictionary with the data to initialize Shells</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Shells instance</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Shells.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">shells_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'control'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Shells.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Shells.from_file" title="Permalink to this definition"></a></dt>
<dd><p>Generates an instance of Shells from a file containing
the datagroup.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>shells_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the type of shell. The supported type are
“closed”, “alpha” or “beta”.</p></li>
<li><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the name of the file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Shells</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – if the shell of the specified type is not present</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Shells.from_string">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Shells.from_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Shells.from_string" title="Permalink to this definition"></a></dt>
<dd><p>Generates an instance of Shells from a string.
Examples of a string:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>a1      1-3                      ( 2 )
b1      1,3                       ( 2 )
b2      1                        ( 2 )
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the string of the datagroup.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Shells</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.control.Shells.irreps">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">irreps</span></span><a class="headerlink" href="#turbomoleio.core.control.Shells.irreps" title="Permalink to this definition"></a></dt>
<dd><p>Set of irreducible representations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.control.Shells.to_datagroup">
<span class="sig-name descname"><span class="pre">to_datagroup</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#Shells.to_datagroup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.Shells.to_datagroup" title="Permalink to this definition"></a></dt>
<dd><p>Generates a string that can be used to set the datagroup in control.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The string of the data group.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.control.Shells.total_electrons">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">total_electrons</span></span><a class="headerlink" href="#turbomoleio.core.control.Shells.total_electrons" title="Permalink to this definition"></a></dt>
<dd><p>Total number of electrons present in all the shells.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the total number of electrons.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Fraction</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.control.adg">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.control.</span></span><span class="sig-name descname"><span class="pre">adg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'control'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#adg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.adg" title="Permalink to this definition"></a></dt>
<dd><p>Function that adds <cite>data_group</cite> with <cite>data_block</cite> from the control file specified by the path.
Comments and empty lines will be removed. The file will be overwritten.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group (key) to be added. The dollar (“$”)
sign will be automatically added if not present.</p></li>
<li><p><strong>data_block</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data block corresponding to the data group.</p></li>
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – path to the control file</p></li>
<li><p><strong>backup_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – filename to which the original file will be backed up.
If None no backup will be created.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if data_group already exists.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.control.cdg">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.control.</span></span><span class="sig-name descname"><span class="pre">cdg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_block</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'control'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#cdg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.cdg" title="Permalink to this definition"></a></dt>
<dd><p>Function that replaces an existing <cite>data_group</cite> with <cite>data_block</cite> from the control file specified
by the path. Comments and empty lines will be removed. The file will be overwritten.</p>
<p>If <cite>data_block</cite> is None it is equivalent to kdg. To set a data group with no
explicit value use and empty string for <cite>data_block</cite> (e.g. to add $uhf the input
should be data_group=”uhf” and data_block=””).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group (key) to be added. The dollar (“$”)
sign will be automatically added if not present.</p></li>
<li><p><strong>data_block</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data block corresponding to the data group.
If None it will simply kill_data_group for the specified data_group value.</p></li>
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – path to the control file</p></li>
<li><p><strong>backup_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – filename to which the original file will be backed up.
If None no backup will be created.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.control.cpc">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.control.</span></span><span class="sig-name descname"><span class="pre">cpc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dest_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force_overwrite</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">control_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#cpc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.cpc" title="Permalink to this definition"></a></dt>
<dd><p>Copies a control file from the specified folder and all files
referenced there to the destination folder.
Creates the destination folder if not already existing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dest_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – path to the destination folder.</p></li>
<li><p><strong>force_overwrite</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True files already present in the
destination folder will be overwritten.</p></li>
<li><p><strong>control_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – path to the directory containing the control file
and the other files to be copied. If None the current dir will
be used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.control.kdg">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.control.</span></span><span class="sig-name descname"><span class="pre">kdg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'control'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#kdg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.kdg" title="Permalink to this definition"></a></dt>
<dd><p>Function that removes <cite>data_group</cite> from the control file specified by the path.
Comments and empty lines will be removed. The file will be overwritten.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group to be removed.</p></li>
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – path to the control file</p></li>
<li><p><strong>strict</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – If True <cite>data_group</cite> should be an exact match.
If False, any Data group starting with <cite>data_group</cite> will be removed.</p></li>
<li><p><strong>backup_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – filename to which the original file will be backed up.
If None no backup will be created.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.control.mdgo">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.control.</span></span><span class="sig-name descname"><span class="pre">mdgo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'control'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backup_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#mdgo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.mdgo" title="Permalink to this definition"></a></dt>
<dd><p>Function that, given a data group that allows several options on separate
line (e.g. $dft), updates the values of the options according to the
dictionary provided.
The option dictionary should have the form:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{&quot;option_name1&quot;: &quot;option_name1 option_value&quot;,
 &quot;option_name2&quot;: &quot;option_name2=option_value&quot;}
</pre></div>
</div>
<p>The key will be used to identify the line to be modified and that line
would be entirely replaced by the value.
Since different options may be defined in different ways, no
attempt is made here to identify the suitable format for the option.
It is responsibility of the caller to specify the line for the option
in the correct format.</p>
<p>If the datagroup is not present will be created with the specified options.</p>
<p>If the entire data group should be modified it would be safer to use
change_data_group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group (key) to be changed. The dollar (“$”)
sign will be automatically added if not present.</p></li>
<li><p><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – The options that should be added or updated. If the
value of one key is None the option will be removed if present.</p></li>
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – path to the control file</p></li>
<li><p><strong>backup_file</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – filename to which the original file will be backed up.
If None no backup will be created.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.control.sdg">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.control.</span></span><span class="sig-name descname"><span class="pre">sdg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'control'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_from_subfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_if_multiple_subfiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_if_missing_subfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_if_regular_and_subfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#sdg"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.sdg" title="Permalink to this definition"></a></dt>
<dd><p>Function that shows the <cite>data_group</cite> from the control file specified by the path.
Comments and empty lines will be removed.
If the filepath is a full path (i.e. not just a file name), it will change
directory to the specified one, so that the subfiles are correctly read.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group to be removed.</p></li>
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – path to the control file</p></li>
<li><p><strong>default</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the default value that will be returned if the
data_group is not present in the list. Default is None.</p></li>
<li><p><strong>show_from_subfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – If True, will show <cite>data_group</cite> from within the
“subfile” if the data block contains a “file=FILENAME”. If
False the “file=FILENAME” block is simply returned. This
supposes that file exists in the current directory.</p></li>
<li><p><strong>raise_if_multiple_subfiles</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether to raise an error if
multiple “file=” directives are present in this data group. If
False, just returns the standard control data block.</p></li>
<li><p><strong>raise_if_missing_subfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether to raise an error if the
subfile does not exist in the current directory or exists but
is empty. If False, just returns the standard control data block.</p></li>
<li><p><strong>raise_if_regular_and_subfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether to raise an error if
data group contains both a reference to a file with a
“file=FILENAME” and regular data block options. If
False, just returns the standard control data block.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the value of the selected datagroup. None if <cite>no data_group</cite> is found.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.control.sdgo">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.control.</span></span><span class="sig-name descname"><span class="pre">sdgo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'control'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/control.html#sdgo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.control.sdgo" title="Permalink to this definition"></a></dt>
<dd><p>Given a data group that allows several options on separate line
(e.g. $dft), returns the value of the option provided.</p>
<p>Since each value may be defined in a different way, the returned
value will include anything after the option specified. It is up
to the caller determine if there are symbols like “=” that should
be removed, depending on the data group and option that is queried.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group (key) to be changed. The dollar (“$”)
sign will be automatically added if not present.</p></li>
<li><p><strong>option</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – The options that should be returned.</p></li>
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – path to the control file.</p></li>
<li><p><strong>default</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the default value that will be returned if the
data_group or the option are not present in the list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value of the option.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-turbomoleio.core.datagroups">
<span id="turbomoleio-core-datagroups-module"></span><h2>turbomoleio.core.datagroups module<a class="headerlink" href="#module-turbomoleio.core.datagroups" title="Permalink to this headline"></a></h2>
<p>Utility module for the “data group” model of TurboMole.</p>
<p>This module contains utility functions to parse, manipulate and write files
formatted using the “data group” convention of TurboMole. Examples of files
that are written in this fashion are the “control” file, the “coord” file, the
“basis” file and many other files written by TurboMole.</p>
<p>Files using the “data group” model of TurboMole are human readable ASCII files
in which data is formally split into consistent “groups”. Each “data group”
consists of a keyword starting with a dollar (“$”) sign (e.g. “$symmetry”,
“$open shell”, “$optimize” …) and its associated data. The associated data
can be empty or just one value/word but it can also be very large (e.g.
molecular orbitals : “$scfmo” data group contained in the “mos” file).</p>
<p>A complete description of the data group model of TurboMole can be found in
the user’s manual, as well as a description of all the keywords available.</p>
<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.datagroups.</span></span><span class="sig-name descname"><span class="pre">DataGroups</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dg_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#DataGroups"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Generic class for data group formatted files and strings.</p>
<p>DataGroups is a generic class for parsing, manipulating and generating
strings/files using the data group format of TurboMole.</p>
<p>Initializes a <cite>DataGroups</cite> class.</p>
<p>The DataGroups object defines a set of key-value-like pairs. A data
group is a key starting with a dollar (“$”) sign. The value
corresponding to the data group is called the data block. When
initializing <cite>DataGroups</cite> from a string (e.g. reading a file), comments
and/or unnecessary lines/spaces/… may be present in that string. In
that case, the initial string is kept as a reference. Note that if
changes are applied to the DataGroups object, the initial string is
not updated as comments may interfere with the modifications. The
actual string corresponding to the data group list (<cite>dg_list</cite>) is
always in line with the data group list.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – A string in the data group format.</p></li>
<li><p><strong>dg_list</strong> (<em>list of str</em>) – A list of the data groups.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.add_data_group">
<span class="sig-name descname"><span class="pre">add_data_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_block</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#DataGroups.add_data_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.add_data_group" title="Permalink to this definition"></a></dt>
<dd><p>Adds <cite>data_group</cite>-&gt;`data_block` to this <cite>DataGroups</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group (key) to be added. The dollar (“$”)
sign will be automatically added if not present.</p></li>
<li><p><strong>data_block</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data block corresponding to the data group.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if data_group already exists.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.adg">
<span class="sig-name descname"><span class="pre">adg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_block</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.adg" title="Permalink to this definition"></a></dt>
<dd><p>Adds <cite>data_group</cite>-&gt;`data_block` to this <cite>DataGroups</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group (key) to be added. The dollar (“$”)
sign will be automatically added if not present.</p></li>
<li><p><strong>data_block</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data block corresponding to the data group.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if data_group already exists.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#DataGroups.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.as_dict" title="Permalink to this definition"></a></dt>
<dd><p>Returns a dictionary representing the DataGroups object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.cdg">
<span class="sig-name descname"><span class="pre">cdg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_block</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.cdg" title="Permalink to this definition"></a></dt>
<dd><p>Changes the value of the <cite>data_group</cite> to the new <cite>data_block</cite> in this
<cite>DataGroups</cite> object. If the key is not present will be added.</p>
<p>It will first apply the kill_data_group and then add_data_group. Note
that in the current implementation, the data group will be moved to
the end of the data groups object (just before $end).</p>
<p>If <cite>data_block</cite> is None it is equivalent to kill_data_group. To set
a data group with no explicit value use an empty string for <cite>data_block</cite>
(e.g. to add $uhf the input should be data_group=”uhf” and data_block=””).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group (key) to be changed. The dollar (“$”)
sign will be automatically added if not present.</p></li>
<li><p><strong>data_block</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data block corresponding to the data group.
If None it will simply kill_data_group for the specified
data_group value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.change_data_group">
<span class="sig-name descname"><span class="pre">change_data_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_block</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#DataGroups.change_data_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.change_data_group" title="Permalink to this definition"></a></dt>
<dd><p>Changes the value of the <cite>data_group</cite> to the new <cite>data_block</cite> in this
<cite>DataGroups</cite> object. If the key is not present will be added.</p>
<p>It will first apply the kill_data_group and then add_data_group. Note
that in the current implementation, the data group will be moved to
the end of the data groups object (just before $end).</p>
<p>If <cite>data_block</cite> is None it is equivalent to kill_data_group. To set
a data group with no explicit value use an empty string for <cite>data_block</cite>
(e.g. to add $uhf the input should be data_group=”uhf” and data_block=””).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group (key) to be changed. The dollar (“$”)
sign will be automatically added if not present.</p></li>
<li><p><strong>data_block</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data block corresponding to the data group.
If None it will simply kill_data_group for the specified
data_group value.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.compare">
<span class="sig-name descname"><span class="pre">compare</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">datagroups</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ignored_dg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_all_diffs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#DataGroups.compare"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.compare" title="Permalink to this definition"></a></dt>
<dd><p>Compares the current object with another DataGroups. Aside from the datagroups
that should be ignored, (define in the ignored_dg argument), the two should contain
the same amount of elements in dg_list and each one from the current object
should have a matching elements in the one that is passed as argument.
To match two strings should have the same number of lines. Each line should have the
same number of chunks. Each chunk should match exactly as a string, except if
they are numbers. In that, if a tol is specified they will be converted to float
and their difference should be lower than the tolerance.</p>
<p>If the two objects match None will be returned, otherwise a message describing
the property that caused the match to fail.</p>
<p>Note that, given the variety of notations supported by Turbomole, this function is to
be intended more for testing purposes rather than as a complete tool to guarantee the
equivalence of two control file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datagroups</strong> (<a class="reference internal" href="#turbomoleio.core.datagroups.DataGroups" title="turbomoleio.core.datagroups.DataGroups"><em>DataGroups</em></a>) – a Datagroups that should match with the current instance.</p></li>
<li><p><strong>tol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – the tolerance allowed when comparing numbers. If None
even the number should match as strings.</p></li>
<li><p><strong>ignored_dg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – a list of datagroups that should be ignored for the comparison.
It is expected to be the name of the datagroup, thus starting with a “$”.
If the “$” symbol is not present will be added before trying to match the
datagroup to skip.</p></li>
<li><p><strong>return_all_diffs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – If True, a list of all differences is returned. If False
(default), a string describing the first source of difference found is returned.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>None if the results match or a string describing a source of difference otherwise</dt><dd><p>(if return_all_diffs is False) or a list of all differences (if return_all_diffs
is True).</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.empty">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">empty</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#DataGroups.empty"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.empty" title="Permalink to this definition"></a></dt>
<dd><p>Creates an empty DataGroups object.</p>
<p>An empty DataGroups object only contains the “$end” data group.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#DataGroups.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.from_dict" title="Permalink to this definition"></a></dt>
<dd><p>Creates DataGroups object from a dictionary.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#DataGroups.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.from_file" title="Permalink to this definition"></a></dt>
<dd><p>Creates DataGroups object reading from a given file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Name of the file from which this DataGroups object
should be read.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.kdg">
<span class="sig-name descname"><span class="pre">kdg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.kdg" title="Permalink to this definition"></a></dt>
<dd><p>Removes <cite>data_group</cite> from this <cite>DataGroups</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group to be removed.</p></li>
<li><p><strong>strict</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – If True <cite>data_group</cite> should be an exact match.
If False, any Data group starting with <cite>data_group</cite> will be
removed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.kill_data_group">
<span class="sig-name descname"><span class="pre">kill_data_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#DataGroups.kill_data_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.kill_data_group" title="Permalink to this definition"></a></dt>
<dd><p>Removes <cite>data_group</cite> from this <cite>DataGroups</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group to be removed.</p></li>
<li><p><strong>strict</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – If True <cite>data_group</cite> should be an exact match.
If False, any Data group starting with <cite>data_group</cite> will be
removed.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.mdgo">
<span class="sig-name descname"><span class="pre">mdgo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.mdgo" title="Permalink to this definition"></a></dt>
<dd><p>Given a data group that allows several options on separate line
(e.g. $dft), updates the values of the options according to the
dictionary provided.
The option dictionary should have the form:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{&quot;option_name1&quot;: &quot;option_name1 option_value&quot;,
 &quot;option_name2&quot;: &quot;option_name2=option_value&quot;}
</pre></div>
</div>
<p>The key will be used to identify the line to be modified and that line
would be entirely replaced by the value.
Since different options may be defined in different ways, no
attempt is made here to identify the suitable format for the option.
It is responsibility of the caller to specify the line for the option
in the correct format.</p>
<p>If the datagroup is not present will be created with the specified options.</p>
<p>If the entire data group should be modified it would be safer to use
change_data_group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group (key) to be changed. The dollar (“$”)
sign will be automatically added if not present.</p></li>
<li><p><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – The options that should be added or updated. If the
value of one key is None the option will be removed if present.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.modify_data_group_options">
<span class="sig-name descname"><span class="pre">modify_data_group_options</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">options</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#DataGroups.modify_data_group_options"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.modify_data_group_options" title="Permalink to this definition"></a></dt>
<dd><p>Given a data group that allows several options on separate line
(e.g. $dft), updates the values of the options according to the
dictionary provided.
The option dictionary should have the form:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{&quot;option_name1&quot;: &quot;option_name1 option_value&quot;,
 &quot;option_name2&quot;: &quot;option_name2=option_value&quot;}
</pre></div>
</div>
<p>The key will be used to identify the line to be modified and that line
would be entirely replaced by the value.
Since different options may be defined in different ways, no
attempt is made here to identify the suitable format for the option.
It is responsibility of the caller to specify the line for the option
in the correct format.</p>
<p>If the datagroup is not present will be created with the specified options.</p>
<p>If the entire data group should be modified it would be safer to use
change_data_group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group (key) to be changed. The dollar (“$”)
sign will be automatically added if not present.</p></li>
<li><p><strong>options</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – The options that should be added or updated. If the
value of one key is None the option will be removed if present.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.ndg">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ndg</span></span><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.ndg" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.number_of_data_groups">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">number_of_data_groups</span></span><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.number_of_data_groups" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.sdg">
<span class="sig-name descname"><span class="pre">sdg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_from_subfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_if_multiple_subfiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_if_missing_subfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_if_regular_and_subfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.sdg" title="Permalink to this definition"></a></dt>
<dd><p>Shows <cite>data_group</cite> from this <cite>DataGroups</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group (key) to be added. The dollar (“$”)
sign will be automatically added if not present.</p></li>
<li><p><strong>strict</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether <cite>data_group</cite> should be an exact match or
if data groups starting with <cite>data_group</cite> are allowed.</p></li>
<li><p><strong>default</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the default value that will be returned if the
data_group is not present in the list. Default is None.</p></li>
<li><p><strong>show_from_subfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – If True, will show <cite>data_group</cite> from
within the “subfile” if the data block contains a
“file=FILENAME”. If False the “file=FILENAME” block is simply
returned. This supposes that file exists in the current
directory.</p></li>
<li><p><strong>raise_if_multiple_subfiles</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether to raise an error if
multiple “file=” directives are present in this data group. If
False, just returns the standard control data block.</p></li>
<li><p><strong>raise_if_missing_subfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether to raise an error if the
subfile does not exist in the current directory or exists but
is empty. If False, just returns the standard data block.</p></li>
<li><p><strong>raise_if_regular_and_subfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether to raise an error if
data group contains both a reference to a file with a
“file=FILENAME” and regular data block options. If
False, just returns the standard data block.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>the value of the selected datagroup. None if no <cite>data_group</cite></dt><dd><p>is found.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if multiple occurrences of <cite>data_group</cite> are found
    (and raise_if_multiple_subfiles is True), if the subfile is
    missing or empty (and raise_if_missing_subfile is True) or if
    regular data block options coexist with a reference to a subfile
     (and raise_if_regular_and_subfile is True).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.sdgo">
<span class="sig-name descname"><span class="pre">sdgo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.sdgo" title="Permalink to this definition"></a></dt>
<dd><p>Given a data group that allows several options on separate line
(e.g. $dft), returns the value of the option provided.</p>
<p>Since each value may be defined in a different way, the returned
value will include anything after the option specified. It is up
to the caller determine if there are symbols like “=” that should
be removed, depending on the data group and option that is queried.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group (key) to be shown. The dollar (“$”)
sign will be automatically added if not present.</p></li>
<li><p><strong>option</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – The options that should be returned.</p></li>
<li><p><strong>default</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the default value that will be returned if the
data_group or the option are not present in the list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value of the option.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.show_data_group">
<span class="sig-name descname"><span class="pre">show_data_group</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_from_subfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_if_multiple_subfiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_if_missing_subfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_if_regular_and_subfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#DataGroups.show_data_group"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.show_data_group" title="Permalink to this definition"></a></dt>
<dd><p>Shows <cite>data_group</cite> from this <cite>DataGroups</cite> object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group (key) to be added. The dollar (“$”)
sign will be automatically added if not present.</p></li>
<li><p><strong>strict</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether <cite>data_group</cite> should be an exact match or
if data groups starting with <cite>data_group</cite> are allowed.</p></li>
<li><p><strong>default</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the default value that will be returned if the
data_group is not present in the list. Default is None.</p></li>
<li><p><strong>show_from_subfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – If True, will show <cite>data_group</cite> from
within the “subfile” if the data block contains a
“file=FILENAME”. If False the “file=FILENAME” block is simply
returned. This supposes that file exists in the current
directory.</p></li>
<li><p><strong>raise_if_multiple_subfiles</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether to raise an error if
multiple “file=” directives are present in this data group. If
False, just returns the standard control data block.</p></li>
<li><p><strong>raise_if_missing_subfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether to raise an error if the
subfile does not exist in the current directory or exists but
is empty. If False, just returns the standard data block.</p></li>
<li><p><strong>raise_if_regular_and_subfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – Whether to raise an error if
data group contains both a reference to a file with a
“file=FILENAME” and regular data block options. If
False, just returns the standard data block.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>the value of the selected datagroup. None if no <cite>data_group</cite></dt><dd><p>is found.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if multiple occurrences of <cite>data_group</cite> are found
    (and raise_if_multiple_subfiles is True), if the subfile is
    missing or empty (and raise_if_missing_subfile is True) or if
    regular data block options coexist with a reference to a subfile
     (and raise_if_regular_and_subfile is True).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.show_data_group_option">
<span class="sig-name descname"><span class="pre">show_data_group_option</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">option</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#DataGroups.show_data_group_option"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.show_data_group_option" title="Permalink to this definition"></a></dt>
<dd><p>Given a data group that allows several options on separate line
(e.g. $dft), returns the value of the option provided.</p>
<p>Since each value may be defined in a different way, the returned
value will include anything after the option specified. It is up
to the caller determine if there are symbols like “=” that should
be removed, depending on the data group and option that is queried.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group (key) to be shown. The dollar (“$”)
sign will be automatically added if not present.</p></li>
<li><p><strong>option</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – The options that should be returned.</p></li>
<li><p><strong>default</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the default value that will be returned if the
data_group or the option are not present in the list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The value of the option.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.show_subfile_fname">
<span class="sig-name descname"><span class="pre">show_subfile_fname</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_group</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">raise_if_regular_and_subfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#DataGroups.show_subfile_fname"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.show_subfile_fname" title="Permalink to this definition"></a></dt>
<dd><p>Extract the name of the file from a datagroup.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the string with the content of the data group.</p></li>
<li><p><strong>raise_if_regular_and_subfile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True will raise an error if the
string contains both a file=FILENAME and other data. If False will
return the filename anyway.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the name of the file, None if no match for “file=filename” is found.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a>)</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.10)"><strong>RuntimeError</strong></a> – if raise_if_regular_and_subfile is True and file=FILENAME
    is not the only content of the string.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.DataGroups.to_file">
<span class="sig-name descname"><span class="pre">to_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#DataGroups.to_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.DataGroups.to_file" title="Permalink to this definition"></a></dt>
<dd><p>Writes this DataGroups object to a file.
If the file exists it will be overwritten.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Name of the file to which this DataGroups object
should be written.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.cleanup_string">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.datagroups.</span></span><span class="sig-name descname"><span class="pre">cleanup_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleanup_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#cleanup_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.cleanup_string" title="Permalink to this definition"></a></dt>
<dd><p>Returns a cleaned data groups string.</p>
<p>This function allows to clean up a data groups string. It allows to :
- remove everything before the first dollar (“$”) sign,
- remove blank lines,
- remove spaces and tabs before “#” comments,
- remove spaces and tabs before “$” signs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – A string that should be in the “data group” format of
TurboMole. Typically, this string is read from file (e.g. control,
coord, basis, …).</p></li>
<li><p><strong>cleanup_types</strong> (<em>list of str</em><em>, </em><em>optional</em>) – List of the cleanup types that
should be performed. Valid types are “BEFORE_FIRST_DOLLAR”,
“BLANK_LINES”, “LEADING_SPACES_DOLLAR” and “LEADING_SPACES_HASH”.
Defaults to None in which case all four types of cleanup will be
performed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A cleaned up string.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – If one of the cleanup_types is not valid, if there is no
    dollar (“$”) sign, if one of the dollar (“$”) or hash (“#”) signs
    is preceded by characters other than a space or a tab in a line or
    if there is no “$end” at the end of the file.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.compare_datagroup_string">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.datagroups.</span></span><span class="sig-name descname"><span class="pre">compare_datagroup_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dg1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dg2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#compare_datagroup_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.compare_datagroup_string" title="Permalink to this definition"></a></dt>
<dd><p>Compares to datagroup strings as split from the DataGroups object.
Return True if the two match.
The two strings should have the same number of lines. Each line should have the
same number of chunks. Chunks will be separated using spaces and “=”. Each chunk
should match exactly as a string, except if they are numbers. In that, if a tol
is specified they will be converted to float and their difference should be lower
than the tolerance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dg1</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the first datagroup string to be compared.</p></li>
<li><p><strong>dg2</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the second datagroup string to be compared.</p></li>
<li><p><strong>tol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – the tolerance allowed when comparing numbers. If None
even the number should match as strings.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if the string match.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.remove_comments">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.datagroups.</span></span><span class="sig-name descname"><span class="pre">remove_comments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">comment_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#remove_comments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.remove_comments" title="Permalink to this definition"></a></dt>
<dd><p>Returns a data group string with comment lines removed.</p>
<p>Comments or additional information in TurboMole is typically specified in
three different ways : a line starting with a hash (“#”) symbol, a data
group with the keyword “$dummy” (can span multiple lines), anything
after the “$end” keyword or anything after a hash (“#”) symbol (so-called
“inline” comments). This function removes all types of comments in
a data group formatted string. Note also that if a newline is added after
the “$end” keyword if not present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – A string that should be in the “data group” format of
TurboMole. Typically, this string is read from file (e.g. control,
coord, basis, …).</p></li>
<li><p><strong>comment_types</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a>, optional) – List of the types of comments
that should be removed. Valid types are “HASH_START”, “DUMMY”,
“AFTER_END” and “HASH_INLINE”. Defaults to None in which case all
four types of comments will be removed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A string without the comment lines.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – If one of the comment_types is not valid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.remove_dg_from_list">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.datagroups.</span></span><span class="sig-name descname"><span class="pre">remove_dg_from_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dg_to_remove</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dg_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">strict</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#remove_dg_from_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.remove_dg_from_list" title="Permalink to this definition"></a></dt>
<dd><p>Returns new list with a data group removed from the initial list.</p>
<p>This function will remove dg_to_remove from a list of data groups. If the
data group is duplicated, all occurrences are removed. The standard usage
is to remove the data group if it is an exact match (i.e. if the data
group to be removed is followed by a space, a tab, a new line or a return).
One can also remove all data groups starting with <cite>dg_to_remove</cite> by using
strict=False.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dg_to_remove</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – Data group to be removed from the list. Can be
given with or without the dollar (“$”) sign.</p></li>
<li><p><strong>dg_list</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – List of strings. Each string should be a data group,
i.e. should start with a dollar (“$”) sign and should not contain
any other dollar sign.</p></li>
<li><p><strong>strict</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – If False, all the data groups starting with
<cite>dg_to_remove</cite> will be removed from the list. Otherwise, the data
group is removed only if it is an exact match of <cite>dg_to_remove</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The list of data groups with <cite>dg_to_remove</cite> removed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.datagroups.split_string_to_dg_list">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.datagroups.</span></span><span class="sig-name descname"><span class="pre">split_string_to_dg_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cleanup_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_comment_types</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/datagroups.html#split_string_to_dg_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.datagroups.split_string_to_dg_list" title="Permalink to this definition"></a></dt>
<dd><p>Splits a string into a list of data groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – A string that should be in the “data group” format of
TurboMole. Typically, this string is read from file (e.g. control,
coord, basis, …).</p></li>
<li><p><strong>cleanup_types</strong> (<em>list of str</em><em>, </em><em>optional</em>) – List of the cleanup types that
should be performed before splitting the string into a list of
data groups. Valid types are “BEFORE_FIRST_DOLLAR”,
“HASH_START”, “DUMMY”, “AFTER_END” and “BLANK_LINES”. Defaults to
None in which case all five types of comments will be removed.</p></li>
<li><p><strong>remove_comment_types</strong> (<em>list of str</em><em>, </em><em>optional</em>) – List of the types of
comments that should be removed before splitting the string into a
list of data groups. Valid types are “BEFORE_FIRST_DOLLAR”,
“HASH_START”, “DUMMY”, “AFTER_END” and “BLANK_LINES”. Defaults to
None in which case all five types of comments will be removed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The list of data groups in the string.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><strong>ValueError</strong></a> – If there is no dollar (“$”) sign in the string, i.e.
    the string is not or incorrectly formatted with respect to the
    data group format of TurboMole.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">split_string_to_dg_list</span><span class="p">(</span><span class="s2">&quot;$title</span><span class="se">\n</span><span class="s2">$end</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">[&#39;$title\n&#39;, &#39;$end\n&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">split_string_to_dg_list</span><span class="p">(</span><span class="s2">&quot;no dollar sign&quot;</span><span class="p">)</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">split_string_to_dg_list</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">$title</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="gp">... </span>                        <span class="s2">&quot;$optimize</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="gp">... </span>                        <span class="s2">&quot; internal   on</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="gp">... </span>                        <span class="s2">&quot; redundant  on</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="gp">... </span>                        <span class="s2">&quot; cartesian  off</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="gp">... </span>                        <span class="s2">&quot; global     off</span><span class="se">\n</span><span class="s2">&quot;</span>
<span class="gp">... </span>                        <span class="s2">&quot; basis      off</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="go">[&#39;$title\n&#39;, &#39;$optimize\n internal   on\n redundant  on\n cartesian  off\n global     off\n basis      off\n&#39;]</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-turbomoleio.core.molecule">
<span id="turbomoleio-core-molecule-module"></span><h2>turbomoleio.core.molecule module<a class="headerlink" href="#module-turbomoleio.core.molecule" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.BondAngle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.molecule.</span></span><span class="sig-name descname"><span class="pre">BondAngle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#BondAngle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.BondAngle" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#turbomoleio.core.molecule.InternalDefinition" title="turbomoleio.core.molecule.InternalDefinition"><code class="xref py py-class docutils literal notranslate"><span class="pre">turbomoleio.core.molecule.InternalDefinition</span></code></a></p>
<p>Class defining a bond angle internal coordinate (bend in TM).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the status of the coordinate. Could be “k”, “f”, “d” or “i”</p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – a lists of 0-based indices for the atoms involved in the
internal coordinate. A list of lists if a linear combination should
be considered. Stored internally as a list of lists.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – weight or list of weights in case of linear
combinations of coordinates. Should have the same length as indices.
If None will be set to a list of 1.0 with the same length as indices.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – value of the internal coordinate. Can be None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.BondAngle.compute_value">
<span class="sig-name descname"><span class="pre">compute_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#BondAngle.compute_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.BondAngle.compute_value" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the value of the internal coordinate based on the given molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>Molecule</em>) – a pymatgen Molecule.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the calculated value of the internal coordinate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.BondAngle.coord_str">
<span class="sig-name descname"><span class="pre">coord_str</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'bend'</span></em><a class="headerlink" href="#turbomoleio.core.molecule.BondAngle.coord_str" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.BondAngle.coord_type">
<span class="sig-name descname"><span class="pre">coord_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'angle'</span></em><a class="headerlink" href="#turbomoleio.core.molecule.BondAngle.coord_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.BondAngle.n_atoms">
<span class="sig-name descname"><span class="pre">n_atoms</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">3</span></em><a class="headerlink" href="#turbomoleio.core.molecule.BondAngle.n_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.CollinearBendingAngle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.molecule.</span></span><span class="sig-name descname"><span class="pre">CollinearBendingAngle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#CollinearBendingAngle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.CollinearBendingAngle" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#turbomoleio.core.molecule.InternalDefinition" title="turbomoleio.core.molecule.InternalDefinition"><code class="xref py py-class docutils literal notranslate"><span class="pre">turbomoleio.core.molecule.InternalDefinition</span></code></a></p>
<p>Class defining an collinear bending angle internal coordinate (linc in TM).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the status of the coordinate. Could be “k”, “f”, “d” or “i”</p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – a lists of 0-based indices for the atoms involved in the
internal coordinate. A list of lists if a linear combination should
be considered. Stored internally as a list of lists.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – weight or list of weights in case of linear
combinations of coordinates. Should have the same length as indices.
If None will be set to a list of 1.0 with the same length as indices.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – value of the internal coordinate. Can be None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.CollinearBendingAngle.compute_value">
<span class="sig-name descname"><span class="pre">compute_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#CollinearBendingAngle.compute_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.CollinearBendingAngle.compute_value" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the value of the internal coordinate based on the given molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>Molecule</em>) – a pymatgen Molecule.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the calculated value of the internal coordinate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.CollinearBendingAngle.coord_str">
<span class="sig-name descname"><span class="pre">coord_str</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'linc'</span></em><a class="headerlink" href="#turbomoleio.core.molecule.CollinearBendingAngle.coord_str" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.CollinearBendingAngle.coord_type">
<span class="sig-name descname"><span class="pre">coord_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'angle'</span></em><a class="headerlink" href="#turbomoleio.core.molecule.CollinearBendingAngle.coord_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.CollinearBendingAngle.n_atoms">
<span class="sig-name descname"><span class="pre">n_atoms</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#turbomoleio.core.molecule.CollinearBendingAngle.n_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.DihedralAngle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.molecule.</span></span><span class="sig-name descname"><span class="pre">DihedralAngle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#DihedralAngle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.DihedralAngle" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#turbomoleio.core.molecule.InternalDefinition" title="turbomoleio.core.molecule.InternalDefinition"><code class="xref py py-class docutils literal notranslate"><span class="pre">turbomoleio.core.molecule.InternalDefinition</span></code></a></p>
<p>Class defining a dihedral angle internal coordinate (tors in TM).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the status of the coordinate. Could be “k”, “f”, “d” or “i”</p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – a lists of 0-based indices for the atoms involved in the
internal coordinate. A list of lists if a linear combination should
be considered. Stored internally as a list of lists.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – weight or list of weights in case of linear
combinations of coordinates. Should have the same length as indices.
If None will be set to a list of 1.0 with the same length as indices.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – value of the internal coordinate. Can be None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.DihedralAngle.compute_value">
<span class="sig-name descname"><span class="pre">compute_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#DihedralAngle.compute_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.DihedralAngle.compute_value" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the value of the internal coordinate based on the given molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>Molecule</em>) – a pymatgen Molecule.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the calculated value of the internal coordinate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.DihedralAngle.coord_str">
<span class="sig-name descname"><span class="pre">coord_str</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tors'</span></em><a class="headerlink" href="#turbomoleio.core.molecule.DihedralAngle.coord_str" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.DihedralAngle.coord_type">
<span class="sig-name descname"><span class="pre">coord_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'angle'</span></em><a class="headerlink" href="#turbomoleio.core.molecule.DihedralAngle.coord_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.DihedralAngle.n_atoms">
<span class="sig-name descname"><span class="pre">n_atoms</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#turbomoleio.core.molecule.DihedralAngle.n_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.Distance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.molecule.</span></span><span class="sig-name descname"><span class="pre">Distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#Distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.Distance" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#turbomoleio.core.molecule.InternalDefinition" title="turbomoleio.core.molecule.InternalDefinition"><code class="xref py py-class docutils literal notranslate"><span class="pre">turbomoleio.core.molecule.InternalDefinition</span></code></a></p>
<p>Class defining a distance internal coordinate (stre in TM).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the status of the coordinate. Could be “k”, “f”, “d” or “i”</p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – a lists of 0-based indices for the atoms involved in the
internal coordinate. A list of lists if a linear combination should
be considered. Stored internally as a list of lists.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – weight or list of weights in case of linear
combinations of coordinates. Should have the same length as indices.
If None will be set to a list of 1.0 with the same length as indices.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – value of the internal coordinate. Can be None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.Distance.compute_value">
<span class="sig-name descname"><span class="pre">compute_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#Distance.compute_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.Distance.compute_value" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the value of the internal coordinate based on the given molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>Molecule</em>) – a pymatgen Molecule.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the calculated value of the internal coordinate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.Distance.coord_str">
<span class="sig-name descname"><span class="pre">coord_str</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'stre'</span></em><a class="headerlink" href="#turbomoleio.core.molecule.Distance.coord_str" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.Distance.coord_type">
<span class="sig-name descname"><span class="pre">coord_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'length'</span></em><a class="headerlink" href="#turbomoleio.core.molecule.Distance.coord_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.Distance.n_atoms">
<span class="sig-name descname"><span class="pre">n_atoms</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#turbomoleio.core.molecule.Distance.n_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.InternalDefinition">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.molecule.</span></span><span class="sig-name descname"><span class="pre">InternalDefinition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#InternalDefinition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.InternalDefinition" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">monty.json.MSONable</span></code></p>
<p>Abstract class for the definition of an internal coordinate according to
the conventions established in turbomole.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the status of the coordinate. Could be “k”, “f”, “d” or “i”</p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – a lists of 0-based indices for the atoms involved in the
internal coordinate. A list of lists if a linear combination should
be considered. Stored internally as a list of lists.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – weight or list of weights in case of linear
combinations of coordinates. Should have the same length as indices.
If None will be set to a list of 1.0 with the same length as indices.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – value of the internal coordinate. Can be None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.InternalDefinition.compute_value">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">compute_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#InternalDefinition.compute_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.InternalDefinition.compute_value" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the value of the internal coordinate based on the given molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>Molecule</em>) – a pymatgen Molecule.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the calculated value of the internal coordinate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.InternalDefinition.coord_str">
<span class="sig-name descname"><span class="pre">coord_str</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">NotImplemented</span></em><a class="headerlink" href="#turbomoleio.core.molecule.InternalDefinition.coord_str" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.InternalDefinition.coord_type">
<span class="sig-name descname"><span class="pre">coord_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">NotImplemented</span></em><a class="headerlink" href="#turbomoleio.core.molecule.InternalDefinition.coord_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.InternalDefinition.from_string">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#InternalDefinition.from_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.InternalDefinition.from_string" title="Permalink to this definition"></a></dt>
<dd><p>Generates a concrete subclass of InternalDefinition from a tm string.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – a turbomole string used in the $intdef datagroup.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of a subclass of InternalDefinition.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.InternalDefinition.get_subclass_from_str">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_subclass_from_str</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord_str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#InternalDefinition.get_subclass_from_str"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.InternalDefinition.get_subclass_from_str" title="Permalink to this definition"></a></dt>
<dd><p>Helper method to get the correct subclass based on the string description</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>coord_str</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the string to determine the subclass.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The appropriate subclass of InternalDefinition.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.InternalDefinition.is_valid">
<span class="sig-name descname"><span class="pre">is_valid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#InternalDefinition.is_valid"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.InternalDefinition.is_valid" title="Permalink to this definition"></a></dt>
<dd><p>If the value is not None, checks if it is consistent with the positions
of the atoms in the given molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>Molecule</em>) – a pymatgen Molecule.</p></li>
<li><p><strong>tol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – the tolerance of the allowed difference between the
internal and the calculated value.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if the values are consistent.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.InternalDefinition.n_atoms">
<span class="sig-name descname"><span class="pre">n_atoms</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">NotImplemented</span></em><a class="headerlink" href="#turbomoleio.core.molecule.InternalDefinition.n_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.InternalDefinition.to_string">
<span class="sig-name descname"><span class="pre">to_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#InternalDefinition.to_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.InternalDefinition.to_string" title="Permalink to this definition"></a></dt>
<dd><p>Generates the turbomole string used in $intdef.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – the index that should be prepended to the generated string.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A string that describes the coordinate and to be used inside $intdef.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.InverseDistance">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.molecule.</span></span><span class="sig-name descname"><span class="pre">InverseDistance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#InverseDistance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.InverseDistance" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#turbomoleio.core.molecule.InternalDefinition" title="turbomoleio.core.molecule.InternalDefinition"><code class="xref py py-class docutils literal notranslate"><span class="pre">turbomoleio.core.molecule.InternalDefinition</span></code></a></p>
<p>Class defining a inverse distance internal coordinate (invr in TM).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the status of the coordinate. Could be “k”, “f”, “d” or “i”</p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – a lists of 0-based indices for the atoms involved in the
internal coordinate. A list of lists if a linear combination should
be considered. Stored internally as a list of lists.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – weight or list of weights in case of linear
combinations of coordinates. Should have the same length as indices.
If None will be set to a list of 1.0 with the same length as indices.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – value of the internal coordinate. Can be None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.InverseDistance.compute_value">
<span class="sig-name descname"><span class="pre">compute_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#InverseDistance.compute_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.InverseDistance.compute_value" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the value of the internal coordinate based on the given molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>Molecule</em>) – a pymatgen Molecule.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the calculated value of the internal coordinate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.InverseDistance.coord_str">
<span class="sig-name descname"><span class="pre">coord_str</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'invr'</span></em><a class="headerlink" href="#turbomoleio.core.molecule.InverseDistance.coord_str" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.InverseDistance.coord_type">
<span class="sig-name descname"><span class="pre">coord_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'length'</span></em><a class="headerlink" href="#turbomoleio.core.molecule.InverseDistance.coord_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.InverseDistance.n_atoms">
<span class="sig-name descname"><span class="pre">n_atoms</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#turbomoleio.core.molecule.InverseDistance.n_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.MoleculeSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.molecule.</span></span><span class="sig-name descname"><span class="pre">MoleculeSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">int_def</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_defined_bonds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#MoleculeSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.MoleculeSystem" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#turbomoleio.core.base.BaseSystem" title="turbomoleio.core.base.BaseSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">turbomoleio.core.base.BaseSystem</span></code></a></p>
<p>Object providing information about the geometry of a molcule and its dynamics.
The geometry is described using a pymatgen Molecule, while internal definitions,
constraints and frozen coordinates are provided as additional attributes.</p>
<p>Notably, since this can be used as an input for define to update the atomic
coordinates, the constraints may be inconsistent with the actual cartesian
coordinates. When parsed from a coord file obtained from define the information
should be consistent. Methods are implemented to check such consistency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>Molecule</em>) – a pymatgen Molecule object with the geometry of
the system. Only supports ordered molecules.</p></li>
<li><p><strong>int_def</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – a list of InternalDefinition.</p></li>
<li><p><strong>frozen_indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.10)"><em>set</em></a>) – a set of indices (0-based) indicating atoms
that should have fixed cartesian coordinates.</p></li>
<li><p><strong>user_defined_bonds</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.10)"><em>set</em></a>) – set of tuples with (index1, symbol, index2),
where the atoms index are 0-based and the symbol can be “-” or “|”.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.MoleculeSystem.add_bond_angle">
<span class="sig-name descname"><span class="pre">add_bond_angle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">vertex</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'f'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_user_def_bonds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#MoleculeSystem.add_bond_angle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.MoleculeSystem.add_bond_angle" title="Permalink to this definition"></a></dt>
<dd><p>Adds a bond angle coordinate to the list of internal coordinates.
Typically used to add frozen coordinates.</p>
<p>Allows to set linear combinations of the coordinate. If a single value is given to the
arguments it will be a simple internal coordinate. If a list of atoms and values are
given this will produce a linear combination of those coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – index (0-based) or list on indices of the first atom(s).</p></li>
<li><p><strong>atom2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – index (0-based) or list on indices of the second atom(s).</p></li>
<li><p><strong>vertex</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – index (0-based) or list on indices of the vertex.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – value of the distance.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – weight or list of weights in case of linear
combinations of coordinates. Should have the same length as the atoms.
If None will be set to a list of 1.0 with the same length as atoms.</p></li>
<li><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the status of the coordinate, can be “k”, “f”, “d” and “i”.</p></li>
<li><p><strong>add_user_def_bonds</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True the pair of atoms will be added to the used defined bonds</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.MoleculeSystem.add_dihedral">
<span class="sig-name descname"><span class="pre">add_dihedral</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'f'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_user_def_bonds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#MoleculeSystem.add_dihedral"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.MoleculeSystem.add_dihedral" title="Permalink to this definition"></a></dt>
<dd><p>Adds a dihedral angle coordinate to the list of internal coordinates.
Typically used to add frozen coordinates.</p>
<p>Allows to set linear combinations of the coordinate. If a single value is given to the
arguments it will be a simple internal coordinate. If a list of atoms and values are
given this will produce a linear combination of those coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – index (0-based) or list on indices of the first atom(s).</p></li>
<li><p><strong>atom2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – index (0-based) or list on indices of the second atom(s).</p></li>
<li><p><strong>atom3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – index (0-based) or list on indices of the third atom(s).</p></li>
<li><p><strong>atom4</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – index (0-based) or list on indices of the fourth atom(s).</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – value of the distance.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – weight or list of weights in case of linear
combinations of coordinates. Should have the same length as the atoms.
If None will be set to a list of 1.0 with the same length as atoms.</p></li>
<li><p><strong>frozen</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – True if the coordinate should be frozen.</p></li>
<li><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the status of the coordinate, can be “k”, “f”, “d” and “i”.</p></li>
<li><p><strong>add_user_def_bonds</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True the pair of atoms will be added to the used defined bonds</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.MoleculeSystem.add_distance">
<span class="sig-name descname"><span class="pre">add_distance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atom1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">atom2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'f'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_user_def_bonds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#MoleculeSystem.add_distance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.MoleculeSystem.add_distance" title="Permalink to this definition"></a></dt>
<dd><p>Adds a distance coordinate to the list of internal coordinates.
Typically used to add frozen coordinates.</p>
<p>Allows to set linear combinations of the coordinate. If a single value is given to the
arguments it will be a simple internal coordinate. If a list of atoms and values are
given this will produce a linear combination of those coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atom1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – index (0-based) or list on indices of the first atom(s).</p></li>
<li><p><strong>atom2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – index (0-based) or list on indices of the second atom(s).</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – value of the distance.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – weight or list of weights in case of linear
combinations of coordinates. Should have the same length as the atoms.
If None will be set to a list of 1.0 with the same length as atoms.</p></li>
<li><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the status of the coordinate, can be “k”, “f”, “d” and “i”.</p></li>
<li><p><strong>add_user_def_bonds</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)"><em>bool</em></a>) – if True the pair of atoms will be added to the
user defined bonds.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.MoleculeSystem.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#MoleculeSystem.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.MoleculeSystem.as_dict" title="Permalink to this definition"></a></dt>
<dd><p>A JSON serializable dict representation of an object.
Overwrites base method to handle sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>json representation of the object.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.MoleculeSystem.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#MoleculeSystem.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.MoleculeSystem.from_dict" title="Permalink to this definition"></a></dt>
<dd><p>Generates object from JSON representation.
Overwrites base method to handle sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>d</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – json representation of the object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of MoleculeSystem.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.MoleculeSystem.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#MoleculeSystem.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.MoleculeSystem.from_file" title="Permalink to this definition"></a></dt>
<dd><p>Creates an instance from a file. Could be a coord file or any other
format supported by pymatgen Molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – path to the file.</p></li>
<li><p><strong>fmt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the format of the data. could be “coord” for Turbomole
coord file or any format supported in pymatgen Molecule.
If None the code would try to infer it from the file name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of MoleculeSystem.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.MoleculeSystem.from_string">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coord'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#MoleculeSystem.from_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.MoleculeSystem.from_string" title="Permalink to this definition"></a></dt>
<dd><p>Creates an instance from a string. Could be the string of a coord file
or any format supported by pymatgen Molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the string with the data.</p></li>
<li><p><strong>fmt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the format of the data. could be “coord” for Turbomole
coord file or any format supported in pymatgen Molecule.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of MoleculeSystem.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.MoleculeSystem.get_int_def_inconsistencies">
<span class="sig-name descname"><span class="pre">get_int_def_inconsistencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#MoleculeSystem.get_int_def_inconsistencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.MoleculeSystem.get_int_def_inconsistencies" title="Permalink to this definition"></a></dt>
<dd><p>Gives a list of the internal coordinates whose values are not consistent
with the values obtained from the molecule object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – tolerance allowed on distances (in bohr).</p></li>
<li><p><strong>ltol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – tolerance allowed on angles (in degrees).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of inconsistent internal coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.MoleculeSystem.has_inconsistencies">
<span class="sig-name descname"><span class="pre">has_inconsistencies</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">atol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ltol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0001</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#MoleculeSystem.has_inconsistencies"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.MoleculeSystem.has_inconsistencies" title="Permalink to this definition"></a></dt>
<dd><p>Checks if any inconsistency in internal coordinates is present.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – tolerance allowed on distances (in bohr).</p></li>
<li><p><strong>ltol</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – tolerance allowed on angles (in degrees).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if inconsistencies are present.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.10)">bool</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.MoleculeSystem.molecule">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">molecule</span></span><a class="headerlink" href="#turbomoleio.core.molecule.MoleculeSystem.molecule" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.MoleculeSystem.to_coord_string">
<span class="sig-name descname"><span class="pre">to_coord_string</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#MoleculeSystem.to_coord_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.MoleculeSystem.to_coord_string" title="Permalink to this definition"></a></dt>
<dd><p>Creates the string of a coord file for this system.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the string representing the system.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.OutOfPlaneAngle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.molecule.</span></span><span class="sig-name descname"><span class="pre">OutOfPlaneAngle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#OutOfPlaneAngle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.OutOfPlaneAngle" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#turbomoleio.core.molecule.InternalDefinition" title="turbomoleio.core.molecule.InternalDefinition"><code class="xref py py-class docutils literal notranslate"><span class="pre">turbomoleio.core.molecule.InternalDefinition</span></code></a></p>
<p>Class defining an out-of-plane angle internal coordinate (outp in TM).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the status of the coordinate. Could be “k”, “f”, “d” or “i”</p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – a lists of 0-based indices for the atoms involved in the
internal coordinate. A list of lists if a linear combination should
be considered. Stored internally as a list of lists.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – weight or list of weights in case of linear
combinations of coordinates. Should have the same length as indices.
If None will be set to a list of 1.0 with the same length as indices.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – value of the internal coordinate. Can be None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.OutOfPlaneAngle.compute_value">
<span class="sig-name descname"><span class="pre">compute_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#OutOfPlaneAngle.compute_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.OutOfPlaneAngle.compute_value" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the value of the internal coordinate based on the given molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>Molecule</em>) – a pymatgen Molecule.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the calculated value of the internal coordinate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.OutOfPlaneAngle.coord_str">
<span class="sig-name descname"><span class="pre">coord_str</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'outp'</span></em><a class="headerlink" href="#turbomoleio.core.molecule.OutOfPlaneAngle.coord_str" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.OutOfPlaneAngle.coord_type">
<span class="sig-name descname"><span class="pre">coord_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'angle'</span></em><a class="headerlink" href="#turbomoleio.core.molecule.OutOfPlaneAngle.coord_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.OutOfPlaneAngle.n_atoms">
<span class="sig-name descname"><span class="pre">n_atoms</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#turbomoleio.core.molecule.OutOfPlaneAngle.n_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.PerpendicularBendingAngle">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.molecule.</span></span><span class="sig-name descname"><span class="pre">PerpendicularBendingAngle</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">status</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#PerpendicularBendingAngle"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.PerpendicularBendingAngle" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#turbomoleio.core.molecule.InternalDefinition" title="turbomoleio.core.molecule.InternalDefinition"><code class="xref py py-class docutils literal notranslate"><span class="pre">turbomoleio.core.molecule.InternalDefinition</span></code></a></p>
<p>Class defining an collinear bending angle internal coordinate (linp in TM).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>status</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the status of the coordinate. Could be “k”, “f”, “d” or “i”</p></li>
<li><p><strong>indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – a lists of 0-based indices for the atoms involved in the
internal coordinate. A list of lists if a linear combination should
be considered. Stored internally as a list of lists.</p></li>
<li><p><strong>weights</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a><em> or </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><em>list</em></a>) – weight or list of weights in case of linear
combinations of coordinates. Should have the same length as indices.
If None will be set to a list of 1.0 with the same length as indices.</p></li>
<li><p><strong>value</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><em>float</em></a>) – value of the internal coordinate. Can be None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.PerpendicularBendingAngle.compute_value">
<span class="sig-name descname"><span class="pre">compute_value</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">molecule</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/molecule.html#PerpendicularBendingAngle.compute_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.molecule.PerpendicularBendingAngle.compute_value" title="Permalink to this definition"></a></dt>
<dd><p>Calculates the value of the internal coordinate based on the given molecule.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>Molecule</em>) – a pymatgen Molecule.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the calculated value of the internal coordinate.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)">float</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.PerpendicularBendingAngle.coord_str">
<span class="sig-name descname"><span class="pre">coord_str</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'linp'</span></em><a class="headerlink" href="#turbomoleio.core.molecule.PerpendicularBendingAngle.coord_str" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.PerpendicularBendingAngle.coord_type">
<span class="sig-name descname"><span class="pre">coord_type</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'angle'</span></em><a class="headerlink" href="#turbomoleio.core.molecule.PerpendicularBendingAngle.coord_type" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="turbomoleio.core.molecule.PerpendicularBendingAngle.n_atoms">
<span class="sig-name descname"><span class="pre">n_atoms</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">4</span></em><a class="headerlink" href="#turbomoleio.core.molecule.PerpendicularBendingAngle.n_atoms" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-turbomoleio.core.periodic">
<span id="turbomoleio-core-periodic-module"></span><h2>turbomoleio.core.periodic module<a class="headerlink" href="#module-turbomoleio.core.periodic" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="turbomoleio.core.periodic.PeriodicSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">turbomoleio.core.periodic.</span></span><span class="sig-name descname"><span class="pre">PeriodicSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">structure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frozen_indices</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodicity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/periodic.html#PeriodicSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.periodic.PeriodicSystem" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#turbomoleio.core.base.BaseSystem" title="turbomoleio.core.base.BaseSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">turbomoleio.core.base.BaseSystem</span></code></a></p>
<p>Object providing information about the geometry of a periodic structure and its dynamics.
The geometry is described using a pymatgen Structure and frozen coordinates are
provided as additional attributes.</p>
<p>Notably, since this can be used as an input for define to update the atomic
coordinates, the constraints may be inconsistent with the actual cartesian
coordinates. When parsed from a coord file obtained from define the information
should be consistent. Methods are implemented to check such consistency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>structure</strong> (<em>Structure</em>) – a pymatgen Structure object with the geometry of
the system. Only supports ordered structures.</p></li>
<li><p><strong>frozen_indices</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.10)"><em>set</em></a>) – a set of indices (0-based) indicating atoms
that should have fixed cartesian coordinates.</p></li>
<li><p><strong>periodicity</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><em>int</em></a>) – periodicity of the system when a Structure object is given.
Can be 1, 2, or 3.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.periodic.PeriodicSystem.as_dict">
<span class="sig-name descname"><span class="pre">as_dict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/periodic.html#PeriodicSystem.as_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.periodic.PeriodicSystem.as_dict" title="Permalink to this definition"></a></dt>
<dd><p>A JSON serializable dict representation of an object.
Overwrites base method to handle sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>json representation of the object.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.periodic.PeriodicSystem.from_dict">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">d</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/periodic.html#PeriodicSystem.from_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.periodic.PeriodicSystem.from_dict" title="Permalink to this definition"></a></dt>
<dd><p>Generates object from JSON representation.
Overwrites base method to handle sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>d</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><em>dict</em></a>) – json representation of the object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of PeriodicSystem.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.periodic.PeriodicSystem.from_file">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/periodic.html#PeriodicSystem.from_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.periodic.PeriodicSystem.from_file" title="Permalink to this definition"></a></dt>
<dd><p>Creates an instance from a file. Could be a coord file or any other
format supported by pymatgen Structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – path to the file.</p></li>
<li><p><strong>fmt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the format of the data. could be “coord” for Turbomole
coord file or any format supported in pymatgen Structure.
If None the code would try to infer it from the file name.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of PeriodicSystem.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.periodic.PeriodicSystem.from_string">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">from_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">string</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'coord'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">periodic_extension</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/periodic.html#PeriodicSystem.from_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.periodic.PeriodicSystem.from_string" title="Permalink to this definition"></a></dt>
<dd><p>Creates an instance from a string. Could be the string of a coord file
or any format supported by pymatgen Structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the string with the data.</p></li>
<li><p><strong>fmt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><em>str</em></a>) – the format of the data. could be “coord” for Turbomole
coord file or any format supported in pymatgen Structure.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An instance of PeriodicSystem.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="turbomoleio.core.periodic.PeriodicSystem.structure">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">structure</span></span><a class="headerlink" href="#turbomoleio.core.periodic.PeriodicSystem.structure" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="turbomoleio.core.periodic.PeriodicSystem.to_coord_string">
<span class="sig-name descname"><span class="pre">to_coord_string</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/periodic.html#PeriodicSystem.to_coord_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.periodic.PeriodicSystem.to_coord_string" title="Permalink to this definition"></a></dt>
<dd><p>Creates the string of a coord file for this system.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>the string representing the system.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)">str</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-turbomoleio.core.symmetry">
<span id="turbomoleio-core-symmetry-module"></span><h2>turbomoleio.core.symmetry module<a class="headerlink" href="#module-turbomoleio.core.symmetry" title="Permalink to this headline"></a></h2>
<p>Module for functionalities related to symmetries of the molecule.</p>
</div>
<div class="section" id="module-turbomoleio.core.utils">
<span id="turbomoleio-core-utils-module"></span><h2>turbomoleio.core.utils module<a class="headerlink" href="#module-turbomoleio.core.utils" title="Permalink to this headline"></a></h2>
<p>Module containing miscellaneous utilities</p>
<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.utils.define_quit">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.utils.</span></span><span class="sig-name descname"><span class="pre">define_quit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/utils.html#define_quit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.utils.define_quit" title="Permalink to this definition"></a></dt>
<dd><p>Runs define but directly quits by sending “qq” interactively.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="turbomoleio.core.utils.get_tm_version">
<span class="sig-prename descclassname"><span class="pre">turbomoleio.core.utils.</span></span><span class="sig-name descname"><span class="pre">get_tm_version</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/turbomoleio/core/utils.html#get_tm_version"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#turbomoleio.core.utils.get_tm_version" title="Permalink to this definition"></a></dt>
<dd><p>Get the turbomole version currently in use.</p>
<p>This basically runs a define and exits at the very beginning and extracts
the version from the header of the output.</p>
</dd></dl>

</div>
<div class="section" id="module-turbomoleio.core">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-turbomoleio.core" title="Permalink to this headline"></a></h2>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="turbomoleio.html" class="btn btn-neutral float-left" title="turbomoleio package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="turbomoleio.core.tests.html" class="btn btn-neutral float-right" title="turbomoleio.core.tests package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2021 BASF SE, Matgenix SRL.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>